var db = require('controllers/database');
var mongoose = require('mongoose');
var countrys = mongoose.model('countrys');

exports.getAllCountry = function(callback){
	countrys.find({},{_id:0,name:1},function(err,data){
		if(data.length != null){
			callback({'res':true,'data':data});
		}else{
			callback({'res':false});
		}
	}).sort({name:1});
}

exports.getAllCity = function(name,callback){
	countrys.aggregate({$unwind:'$city'},{$match:{name:name}},{$sort:{'city.name':1}},function(err,data){
		if(data.length != null){
			var dataCity = [];
      for (i = 0; i < data.length; i++) {
        dataCity.push({ 'name':data[i].city.name });
      }
			callback({'res':true,'data':dataCity});
		}else{
			callback({'res':false});
		}
	});
}
